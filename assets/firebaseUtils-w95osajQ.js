import{s as o,g as s,h as c,i as m,k as g,l as u,G as w,m as f,n as l,f as y,o as p,p as P,q as v,t as k}from"./index-BYLV5N22.js";const b=e=>{switch(e.code){case"auth/user-not-found":return"Email is not registered. Please check your email or sign up.";case"auth/wrong-password":case"auth/invalid-password":case"auth/invalid-email":case"auth/invalid-credential":return"Invalid email or password. Please try again.";case"auth/network-request-failed":return"Network error. Please check your connection and try again.";case"auth/email-already-exists":return"Email already in use. Please choose a different email.";case"auth/too-many-requests":return"Too many unsuccessful login attempts. Please try again later.";case"auth/invalid-id-token":case"auth/id-token-expired":case"auth/id-token-revoked":return"There was a problem with your authentication. Please try signing in again.";case"auth/invalid-verification-code":case"auth/invalid-verification-id":return"Invalid verification code. Please try again.";case"auth/account-exists-with-different-credential":return"An account already exists with a different sign-in method for that email.";case"auth/requires-recent-login":return"You need to re-authenticate to perform this action. Please login again.";case"auth/user-disabled":return"This user account has been disabled. Please contact support.";case"auth/invalid-captcha-response":return"Invalid reCAPTCHA response. Please try the verification again.";case"auth/missing-android-pkg-name":case"auth/missing-continue-uri":case"auth/missing-ios-bundle-id":case"auth/operation-not-allowed":return"Internal configuration error. Please contact support.";default:return"An unexpected error occurred. Please try again."}},I=e=>{switch(e.code){case"auth/email-already-in-use":return"Email is already in use. Please choose another one.";case"auth/weak-password":return"Password is too weak. Please choose a stronger password.";case"auth/invalid-email":return"Invalid email format. Please enter a valid email address.";case"auth/operation-not-allowed":return"This sign-up method is not allowed. Please contact support.";case"auth/network-request-failed":return"Network error. Please check your connection and try again.";case"auth/too-many-requests":return"Too many requests. Please try again later.";case"auth/invalid-captcha-response":return"Invalid CAPTCHA response. Please try again.";default:return"An unexpected error occurred. Please try again."}},E=e=>{switch(e.code){case"auth/user-not-found":return"No user found with this email address. Please check and try again.";case"auth/invalid-email":return"Invalid email address format. Please enter a valid email address.";case"auth/network-request-failed":return"Network error. Please check your internet connection and try again.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return"An unexpected error occurred. Please try again later."}},x=async(e,r,n)=>{try{await o(s,c);const a=await m(s,e,r);return await g(a.user),console.log("Verification email sent."),await u(s),n("/auth/login"),a.user}catch(a){throw console.error("Error signing up:",a),a}},q=async(e,r)=>{const n=new w;try{const a=await f(s,n),{email:t,uid:i}=a.user,h=await d(l,i);r({email:t,userId:i,isAdmin:h}),localStorage.setItem("sessionStart",Date.now().toString()),e("/feedback/submit",{replace:!0})}catch(a){return a instanceof y?E(a):"An unexpected error occurred. Please try again."}return null},S=async(e,r,n,a)=>{try{await o(s,c);const t=await p(s,e,r);if(t.user.emailVerified){const i=await d(l,t.user.uid);a({email:t.user.email,userId:t.user.uid,isAdmin:i}),localStorage.setItem("sessionStart",Date.now().toString()),n("/feedback/submit")}else{await u(s);const i=new Error("Please verify your email before logging in.");throw i.name="UnverifiedEmailError",i}}catch(t){throw t}},d=async(e,r)=>{const n=P(e,`users/${r}`),a=await v(n);return a.exists()?a.data().isAdmin:!1},T=async e=>{try{await k(s,e)}catch(r){throw r}};export{q as a,x as b,I as c,T as d,E as e,b as h,S as s};
